---
title: "Learning R with Dr. Hu and His Friends"
output: 
  learnr::tutorial:
    progressive: true
    allow_skip: true
    css: "style_ui.css"
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
library(learnr)
library(tidyverse)
library(lubridate) #æ—¶é—´æ•°æ®å¤„ç†
library(gapminder) 
```

# æ•°æ®è¾“å…¥ï¼è¾“å‡º

## å¯¼è¯­

å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯èŒèŒï¼æ¬¢è¿æ¥åˆ°â€œLearning R with Dr. Hu and His Friendsâ€!

ç°åœ¨ä½ è¿›å…¥çš„æ˜¯é€šå¾€`R expert`ä¹‹è·¯çš„ç¬¬ä¸€ç«™ï¼Œæˆ‘å°†å’Œèƒ¡è€å¸ˆä¸€èµ·å¼•é¢†ä½ èµ°å…¥Rçš„ä¸–ç•Œï¼Œé¢†ç•¥å…¶ä¸­é£é‡‡ã€‚

å¸Œæœ›è¿™èŠ‚è¯¾èƒ½è®©ä½ åˆæ­¥äº†è§£Rè¯­è¨€çš„**è¯´è¯é£æ ¼**ï¼å¯¹ï¼Œå°±æ˜¯â€œè¯´è¯é£æ ¼â€â€”â€”Rä½œä¸ºä¸€ç§ç¼–ç¨‹è¯­è¨€ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ç§ä¸è®¡ç®—æœºå¯¹è¯çš„æ–¹å¼ã€‚
æˆ‘ä»¬å¸¸è§çš„C++, Javaå’ŒPythonä¹Ÿæ˜¯å¦‚æ­¤ã€‚
äº†è§£ä¸€ç§è¯­è¨€çš„â€œè¯´è¯æ–¹å¼â€çš„ç‰¹ç‚¹æœ‰åŠ©äºæˆ‘ä»¬æ›´å¥½çš„é€šè¿‡å®ƒä¸è®¡ç®—æœºè¿›è¡Œâ€œ**æ²Ÿé€š**â€ã€‚

## çŸ¥è¯†ç‚¹

### å¯¹è±¡æ˜¯ä»€ä¹ˆï¼Ÿ

Ræ˜¯å¯¹è±¡æŒ‡å‘å‹ç¼–ç¨‹ï¼ˆObject-oriented programmingï¼‰è¯­è¨€ã€‚
è¿™ç±»è¯­è¨€çš„åŸºæœ¬æ“ä½œå•ä½æ˜¯ç±»ï¼ˆclassï¼‰å’Œå¯¹è±¡ï¼ˆobjectï¼‰ã€‚
å…¶ä¸­ï¼Œç±»æ˜¯æ¦‚æ‹¬æ€§çš„ï¼Œè§„å®šäº†å…¶æ‰€å±å¯¹è±¡çš„å±æ€§ç±»å‹ï¼Œæ˜¯å…¶æ‰€è¾–å¯¹è±¡çš„æ¨¡æ¿ï¼Œæ¯”å¦‚åœ¨`å›½å®¶`è¿™ä¸€ç±»ä¸‹ï¼Œæ‰€æœ‰ä¸ªä½“éƒ½åŒ…å«äººå£ã€ç–†åŸŸã€æ”¿æƒç±»å‹ç­‰å±æ€§ã€‚
å¯¹è±¡æ˜¯ç±»æ¨¡æ¿çš„ä¸€ä¸ªå…·è±¡ï¼Œæ¯”å¦‚åŸºäº`å›½å®¶`ç±»å¯ä»¥åˆ›å»ºçš„å¯¹è±¡`ä¸­å›½`ã€`æ³•å›½`ã€`çˆ±å°”å…°`ç­‰ã€‚


### å‡½æ•°æ˜¯ä»€ä¹ˆï¼Ÿ

```{r out.width = "80%", echo = FALSE}
knitr::include_graphics("images/handShadow.gif")
```

```{r funIllustration, eval = FALSE}
light <- function(finger){
  {{shadow <- finger + 5}}
}
handShadow <- light(finger = 3)
handShadow
```

### æ•°æ®åŒ…æ˜¯ä»€ä¹ˆ

æ•°æ®åŒ…ï¼ˆpackageï¼‰ç›¸å½“äºä½ æ™ºèƒ½æ‰‹æœºé‡Œçš„appã€‚
å½“ä½ ä¹°åˆ°æ‰‹æœºçš„æ—¶å€™ï¼ŒåŠŸèƒ½éƒ½æ˜¯æœ‰é™çš„ã€‚
é€šè¿‡appï¼Œä½ å¯ä»¥è®©æ‰‹æœºçš„åŠŸèƒ½æå¤§ä¸°å¯Œèµ·æ¥ã€‚

###

æœ¬ç« èŠ‚æˆ‘ä»¬å°†è¦å­¦ä¹ çš„çŸ¥è¯†ç‚¹æœ‰ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  è¾“å…¥/è¾“å‡ºæ•°æ®
2.  ä¿å­˜æ•°æ®
3.  åˆå¹¶æ•°æ®

## æ•°æ®è¾“å…¥

### å¯¹è±¡èµ‹å€¼ `<-`

è¯­æ³•ï¼š<åç§°> `<-` <å¯¹è±¡>

ä¸¾ä¾‹ï¼š

```{r object}
aValidObject <- 1:5
aValidObject # å±•ç¤ºå¯¹è±¡å†…å®¹
```

+ å‘½åè§„åˆ™
    1. ä¸è¦ä»¥æ•°å­—å¼€å¤´ (é”™è¯¯: `1stday`)
    1. é™¤äº† `.` å’Œ `-`ä»¥å¤–æ²¡æœ‰å…¶ä»–ç‰¹æ®Šç¬¦å·(é”™è¯¯: `M&M`)
    1. åŒºåˆ†å¤§å°å†™ (`X != x`) `!è¡¨ç¤ºâ€œéâ€/â€œå¦â€ï¼Œ`!=`è¡¨ç¤ºâ€œä¸ç­‰äºâ€
    1. å¦‚éœ€å¿…è¦è¯·å‹¿é‡å†™å†…ç½®å‡½æ•° (é¿å…: `list <- c(1:5)`)


### å¦ä¸€ç§èµ‹å€¼ç¬¦ `=`

ç”¨æ³•å’Œ`<-`ç­‰æ•ˆã€‚
ä½†æ›´å¤šå†™è¿‡æ›´å€¾å‘ä½¿ç”¨ `<-` è€Œä¸æ˜¯ `=`ã€‚

Why?

```{r out.width = "80%", echo = FALSE}
knitr::include_graphics("images/APLkeyBoard.png")
```

+ æŒ‡å‘ç›´è§‚

```{r arrow}
a <- 12
25 -> b
```

+ ä¸å¯ä»¥å’Œâ€œç­‰äºâ€æ··æ·†ï¼ˆæœ¬ç« æœ€åä¸€èŠ‚ä¼šè¯¦è¿°ï¼‰
+ å¯ä»¥é€šè¿‡å¿«æ·é”®ä¸€æ¬¡æ€§è¾“å…¥
    + PC: `Alt + -`
    + Mac: `option + -`


### ä»€ä¹ˆæ—¶å€™ç”¨ "="?
å½“ä½ ä¸æƒ³åˆ›å»ºä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™,è¯·çœ‹ä»¥ä¸‹ä¾‹å­

```{r sideEffect, exercise = TRUE}
median(y <- 1:10); y
median(x = 1:10); x
```

### æŒ‘æˆ˜æ—¶é—´ï¼

è¯·åˆ›å»ºä¸€ä¸ªåˆè§„å’Œä¸åˆè§„çš„å¯¹è±¡ï¼š

```{r objectEg, exercise = TRUE}
# ä¸€ä¸ªåˆè§„å¯¹è±¡

# è¯•ç€åˆ›å»ºä¸€ä¸ªä¸åˆè§„çš„å¯¹è±¡

```

> èŒèŒï¼šå¯¹è±¡èµ‹å€¼æ˜¯Rè¯­è¨€æœ€åŸºæœ¬çš„æ“ä½œã€‚æˆ‘ä¹ æƒ¯ç®€å•æŠŠè¿™ä¸ªåŠ¨ä½œç†è§£æˆç»™ç®­å¤´å³è¾¹çš„å¯¹è±¡ï¼ˆä¸€æ¡æˆ–ä¸€ç»„æ•°æ®ã€ä¸€ä¸ªæ•°æ®ç»“æœã€ä¸€å¹…å›¾ç­‰ç­‰ï¼‰å–ä¸ªåå­—ï¼Œå˜¿å˜¿ğŸ˜‹

## æ•°æ®è¯»å–

### å†…ç½®æ•°æ®

```{r mtcars, exercise}
data(mtcars)
#data(gapminder::gapminder)
```

### å¯ç›´æ¥è¯»å–æ•°æ®

å¯è¯»å–æ•°æ®ç±»å‹

- `.RDS` (å•ä¸€å¯¹è±¡)
- `.RData` (å¤šä¸ªå¯¹è±¡)
- `.txt` 
- `.csv`

è¯­æ³•ï¼š <åç§°>`<-` <è¯»å–å‡½æ•°>(<æ•°æ®è·¯å¾„>)

```{r input, eval = FALSE}
df_rds <- readRDS("aDataset.rds")
df_txt <- read.table("D:/aDataset.txt")
df_csv <- read.csv("./aDataset.csv")
```


### è°ƒç”¨åŒ…è¯»å–æ•°æ®

é€šè¿‡`library`æˆ–è€…`require`è°ƒç”¨æ•°æ®åŒ…ï¼Œç„¶åä½¿ç”¨å…¶ä¸­çš„å‘½ä»¤ã€‚


```{r eval=FALSE}
# SPSS, Stata, SAS
library(haven)
df_spss <- read_spss("<FileName>.sav")
df_stata <- read_dta("<FileName>.dta")
df_sas <- read_sas("<FileName>.sas7bdat")  

# è¡¨æ ¼çš„å¿«é€Ÿå¯¼å…¥
libraryï¼ˆreaderï¼‰
df_csv <- read.csv("<FileName>.csv")
df_table <- read.table("<FileName>.csv/txt")

# Excelè¡¨æ ¼
library(readxl)
df_excel <- read_excel("<FileName>.xls")
df_excel2 <- read_excel("<FileName>.xlsx")

# JSON (JavaScript Object Notation)
library(rjson)
df_json <- fromJSON(file = "<FileName>.json" )

# XML/Html
library(xml)
df_xml <- xmlTreeParse("<url>")
df_html <- readHTMLTable(url, which=3)
```


## æ•°æ®åˆ†ç±»

1. å‘é‡ (vector)
2. çŸ©é˜µ (matrix)
3. æ•°æ®æ¡† (data frame)
4. åˆ—è¡¨ (list)
5. é˜µåˆ— (array)


### å‘é‡

å‘é‡ï¼ˆvectorï¼‰æ˜¯Rè¯­è¨€ä¸­æœ€åŸºæœ¬çš„æ•°æ®ç±»å‹ï¼Œæ‰§è¡Œç»„åˆåŠŸèƒ½çš„å‡½æ•°`c()`å¯ç”¨æ¥åˆ›å»ºå‘é‡

+ æ•°å­—å‘é‡ï¼ˆnumeric vectorï¼‰

```{r numeric, exercise = TRUE}
vec_num1 <- c(1, 2, 3) #æ•´æ•°
vec_num2 <- c(1:5) #è¡¨ç¤º1-5 
vec_num3 <- c(1.5, -2.34, NA)

vec_num1; vec_num2; vec_num3

# c(1.5:3) çš„ç»“æœæ˜¯ä»€ä¹ˆ?
```

æ³¨æ„: 1. `NA`è¡¨ç¤ºçš„æ˜¯: not available
      2. å•ä¸ªå‘é‡ä¸­çš„æ•°æ®å¿…é¡»æ‹¥æœ‰ç›¸åŒçš„ç±»å‹ï¼ˆæ•°å€¼å‹ã€å­—ç¬¦å‹æˆ–é€»è¾‘å‹ï¼‰

###

+ å­—ç¬¦å‘é‡ï¼ˆcharacter vectorï¼‰

```{r character, exercise = TRUE}
vec_chr <- c("R is hard.", "But I can nail it.")
vec_chr
```

###

+ é€»è¾‘å‘é‡ï¼ˆlogic vectorï¼‰

```{r logic, exercise = TRUE}
vec_tf <- c(TRUE, TRUE, FALSE)
vec_tf
# c(TRUE, TRUE, FALSE) == c(1, 1, 0)
```


###

+ ç±»åˆ«å‘é‡ï¼ˆfactor vectorï¼‰

```{r factor, exercise = TRUE}
vec_fac <- factor(c(1, 2, 2, 3), labels = c("Apple", "Pear", "Orange"))
vec_fac
levels(vec_fac)
```

æ°´å¹³(Levels)å’Œæ ‡ç­¾(Lables)

```{r level, exercise = TRUE}
vec_fac2 <- factor(c(1, 2, 2, 3), levels = c(3, 2, 1), labels = c("Apple", "Pear", "Orange"))
vec_fac2
```

> èŒèŒï¼šä½ å¯ä»¥é€šè¿‡`?factor`å’Œ[`forcats`æ‰‹å†Œ](https://forcats.tidyverse.org/)äº†è§£æ›´å¤šå…³äºç±»åˆ«å˜é‡çš„çŸ¥è¯†ã€‚

###

+ æ—¶é—´å‘é‡ï¼ˆPOSIXct/POSXlt vectorï¼‰

`as.POSIXct` (numeric input), `as.POSIXlt` (character input)
å…¶ä¸­POSIXctæ˜¯æ•´æ•°å­˜å‚¨ã€POSIXltæ˜¯åˆ—è¡¨å­˜å‚¨
```{r time, exercise}
Sys.time() # è·å–å½“å‰æ—¶é—´
today()   # è·å–å½“æ—¥çš„ å¹´æœˆæ—¥
now()  # è·å–å½“æ—¥çš„ å¹´æœˆæ—¥ æ—¶åˆ†ç§’  æ—¶åŒº
# CSTä¸ºæ“ä½œæ—¶ç”µè„‘ipæ‰€åœ¨çš„æ—¶åŒº

# The full pack
time1 <- Sys.time()
time2 <- as.POSIXlt(Sys.time())
time2$wday # week of the day

## å¦‚æœæˆ‘åªåœ¨ä¹æ—¥æœŸå‘¢ï¼Ÿ
```

```{r time-solution}
Sys.Date()
date1 <- as.Date("2019-01-02")
class(date1)  # æŸ¥çœ‹æ•°æ®ç±»å‹
```

###

+ æ—¶é—´å¤„ç†åŒ…`lubridate`
    1. å®æ—¶è·å–æ—¥æœŸå‹æ•°æ®å’Œæ—¥æœŸæ—¶é—´å‹æ•°æ®
    2. è‡ªå®šä¹‰ç”Ÿæˆå…¬å¼åŒ–çš„æ—¥æœŸæ•°æ®
    3. å®ç°æ—¥æœŸå‹æ•°æ®å’Œæ—¥æœŸæ—¶é—´å‹æ•°æ®çš„è½¬åŒ–
    4. åˆ—å‡ºæå–Dateç±»ä¸­çš„å¹´æœˆæ—¥æ—¶åˆ†ç§’ç­‰å…ƒç´ 

### çŸ©é˜µ

çŸ©é˜µï¼ˆmatrixï¼‰æ˜¯å…·æœ‰ç»´åº¦å±æ€§çš„å‘é‡ï¼ŒçŸ©é˜µéƒ½æ˜¯äºŒç»´çš„ï¼Œå’Œå‘é‡ç±»ä¼¼ï¼ŒçŸ©é˜µä¸­ä¹Ÿä»…èƒ½åŒ…å«ä¸€ç§æ•°æ®ç±»å‹

```{r out.width = "80%", echo = FALSE}
knitr::include_graphics("images/matrix.gif")
```

###

åˆ›å»ºçŸ©é˜µä¸»è¦æœ‰ä¸‰ç§æ–¹æ³•ï¼š

+ æ‰‹åŠ¨åˆ›å»º: `matrix`
```{r matrixR}
A <- matrix(1:20, ncol = 4) #åˆ›å»ºä¸€ä¸ªæ•°å­—1-20ï¼Œ5è¡Œ4åˆ—çš„çŸ©é˜µï¼ˆcolä¸ºåˆ—ï¼Œrowä¸ºè¡Œï¼‰
A
A[2, 3]
```

###

+ çŸ¢é‡+ç»´åº¦: `dim()`
```{r}
M <- c(1:20)
dim(M) <- c(4,5) #4è¡Œ5åˆ—       
M
```

###

+ ç»‘å®šè¡Œ/åˆ—: `cbind()`å’Œ`rbind()`
```{r}
x <- 1:4
y <- 5:8
cbind (x, y)
rbind (x, y)
```

### é˜µåˆ—

é˜µåˆ—ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯åˆ—çš„â€œé˜µâ€ï¼Œå¯ç”¨äºè®°å½•æ›´é«˜ç»´åº¦çš„æ•°æ®ï¼Œå¯é€šè¿‡`array`å‡½æ•°åˆ›å»ºã€‚

```{r array}
# åˆ›å»ºä¸¤ä¸ªé•¿åº¦ä¸åŒçš„å‘é‡ã€‚
vector1 <- c(5,9,3)
vector2 <- c(10,11,12,13,14,15)

# æŠŠè¿™äº›å‘é‡è¾“å…¥åˆ°æ•°ç»„ä¸­ã€‚
result <- array(c(vector1,vector2),dim = c(3,3,2))
result
```

### åˆ—è¡¨

åˆ—è¡¨ï¼ˆlistï¼‰æ˜¯ä¸€ç§å¯åŒ…å«å¤šç§ä¸åŒç±»å‹å¯¹è±¡çš„å‘é‡ï¼Œæ˜¯ä¸€äº›å¯¹è±¡ï¼ˆæˆ–æˆåˆ†ï¼Œcomponentï¼‰çš„æœ‰åºé›†åˆï¼Œåˆ—è¡¨ä¸­æ—¢å¯ä»¥æœ‰å‘é‡ä¹Ÿå¯ä»¥æœ‰çŸ©é˜µç­‰ã€‚

```{r list}
ls_monks <- list(name = c("Wukong Sun", "Sanzang Tang", "Wuneng Zhu", "Wujing Sha"),
                 power = c(100, 20, 90, 40),
                 buddha = c(TRUE, TRUE, FALSE, FALSE))

ls_monks
```

### æ•°æ®æ¡†

æ•°æ®æ¡†ï¼ˆData Frameï¼‰æ˜¯ä¸€ç§ç‰¹æ®Šçš„åˆ—è¡¨/çŸ©é˜µï¼Œå…¶ä¸­æ‰€ç”¨å…ƒç´ é•¿åº¦éƒ½ç›¸ç­‰ï¼Œåˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½å¯ä»¥çœ‹ä½œä¸€åˆ—ï¼Œæ¯ä¸ªå…ƒç´ çš„é•¿åº¦å¯ä»¥çœ‹ä½œè¡Œæ•°ã€‚

åœ¨Excelä¸­:

```{r excel, out.width = "80%", echo = FALSE}
knitr::include_graphics("images/excel-r1.png")
```

åœ¨Rä¸­ï¼Œä½¿ç”¨`data.frame()`åˆ›å»ºæ•°æ®æ¡†

```{r dataframe}
df_toy <- data.frame(female = c(0,1,1,0),
           age = c(29, 39, 38, 12),
           name = c("Iron Man", "Black Widow", "Captain Marvel", "Captain America"))

df_toy
```

åœ¨Rstudioä¸­:

```{r rstudio}
knitr::include_graphics("images/excel-r2.png")
```


## åˆå¹¶æ•°æ®

### 
æˆ‘ä»¬é‡‡ç”¨ç‘å…¸å­¦è€…Hans Roslingåœ¨[TED æ¼”è®²](https://www.ted.com/talks/hans_rosling_shows_the_best_stats_you_ve_ever_seen?utm_campaign=tedspread--b&utm_medium=referral&utm_source=tedcomshare)ä¸­ä½¿ç”¨çš„äººå£æ•°æ®ä½œä¸ºæ¡ˆä¾‹æ¥è¿›è¡Œä¸‹é¢çš„è®²è¿°ã€‚
è®©æˆ‘ä»¬é¦–å…ˆæ¥çœ‹çœ‹æ•°æ®

```{r toy}
library(gapminder)
gapminder
```

### è¡Œåˆå¹¶

```{r out.width = "95%", echo = FALSE}
knitr::include_graphics("images/rowBind.png")
```

å‡è®¾æˆ‘ä»¬æœ‰äºšæ´²å’Œæ¬§æ´²äººå£æ•°æ®ï¼Œå¦‚ä½•æŠŠå®ƒä»¬åˆå¹¶åœ¨ä¸€èµ·å‘¢ï¼Ÿ

```{r ex_append, exercise = TRUE, exercise.eval = TRUE}
gapminder_asia <- gapminder[gapminder$continent == "Asia", 1:2]
gapminder_europe <- gapminder[gapminder$continent == "Europe", 1:2]
```

```{r ex_append-solution}
library(dplyr)

gapminder_eurasia <- bind_rows(gapminder_asia, gapminder_europe) #æŒ‰è¡Œè¿æ¥ï¼Œä¸éœ€è¦åˆ—åç›¸åŒ
```

### åˆ—åˆå¹¶

å¦‚æœæˆ‘ä»¬æœ‰ä¸€ç³»åˆ—çš„å˜é‡ï¼Œéƒ½æ˜¯æ¥è‡ªåŒä¸€ç»„å›½å®¶çš„ï¼Œå¦‚ä½•æŠŠä»–ä»¬æ•´åˆåœ¨ä¸€èµ·ï¼Ÿ

```{r out.width = "95%", echo = FALSE}
knitr::include_graphics("images/columnBind.png")
```

```{r ex_columnBind, exercise = TRUE}
gapminder_country <- gapminder$country
gapminder_year <- gapminder$year
```

```{r ex_columnBind-solution}
bind_cols(gapminder_country, gapminder_year) #æŒ‰åˆ—ç»“åˆæ—¶éœ€è¦è¡Œåç›¸åŒ
```

### ç´¢å¼•åˆå¹¶

`dplyr::*_joint`å‡½æ•°

```{r out.width = "95%", echo = FALSE}
knitr::include_graphics("images/join.png")
```

1. å·¦è¿æ¥ï¼ˆleft_jion): ä¿ç•™xä¸­çš„æ‰€æœ‰è§‚æµ‹,å¦‚æœxä¸­çš„keyå˜é‡,åœ¨yä¸­æœ‰å¤šä¸ªåŒæ ·çš„key,é‚£ä¹ˆæ‰€æœ‰çš„ç»“åˆå¯èƒ½éƒ½ä¼šç½—åˆ—å‡ºæ¥ã€‚

```{r left_jion, eval=FALSE}
left_join(x, y, by = "key")
```

2. å³è¿æ¥(right_jion): ä¿ç•™ y ä¸­çš„æ‰€æœ‰è§‚æµ‹

```{r right_jion, eval=FALSE}
right_join(x, y, by = "key")
```

### æŒ‘æˆ˜æ—¶é—´

å¦‚æœæˆ‘ä»¬æœ‰ä¸¤ç»„æ•°æ®åˆ†åˆ«æ¥è‡ªä¸åŒçš„æºå¤´ï¼Œåˆæœ‰ä¸åŒçš„è¡Œæ•°ï¼Œè¯¥å¦‚ä½•æŠŠå®ƒä»¬å‡†ç¡®çš„åˆå¹¶åœ¨ä¸€èµ·å‘¢ï¼Ÿ

```{r ex_join, exercise = TRUE}
gapminder_country <- select(gapminder, country, year)
gapminder_year <- select(gapminder, year, pop)
```

```{r ex_join-solution}
gapminder_countryYear<- left_join(gapminder_country, gapminder_year)
```

> èŒèŒï¼šåœ¨æ“ä½œä¸Šï¼Œè¡Œåˆå¹¶çš„å…³é”®æ˜¯æ¯è¡Œéƒ½æœ‰ç›¸åŒçš„åˆ—ï¼Œåˆ—åˆå¹¶åˆ™éœ€è¦æ¯åˆ—è¡Œæ•°ç›¸åŒã€‚ç´¢å¼•åˆå¹¶æ—¶ï¼Œä¸€å®šè¦ç¡®å®šä¸¤ä¸ªæ•°æ®çš„ç´¢å¼•å†…å®¹æ˜¯èƒ½å¾ˆå¥½å¯¹åº”çš„ï¼Œå¦åˆ™åæœæƒ¨çƒˆâ€¦â€¦è¯·ä¸è¦é—®æˆ‘æ˜¯æ€ä¹ˆçŸ¥é“çš„~

## æ•°æ®è¾“å‡º

è¯­æ³•ï¼š<å‡½æ•°>(<ä»£å­˜æ•°æ®>ï¼Œfile = <å­˜å‚¨è·¯å¾„>)

### å‚¨å­˜ä¸ºRæ•°æ®

```{r saving, eval = FALSE}
saveRDS(gapminder_country, file = "gapminder_country.rds")
save(gapminder_country, gapminder_year, file = "gapminder.rdata")
```


### å‚¨å­˜ä¸ºcsvæ–‡ä»¶

```{r savingCSV, eval = FALSE}
write.csv(gapminder_country, file = "gapminder_country.csv")
```

æç¤º: å¦‚æœä½ çš„æ•°æ®æ˜¯ä¸­æ–‡çš„ï¼Œå¯èƒ½ä¼šå‡ºç°å­˜å‚¨csvä¹±ç ç°è±¡ã€‚
è¿™ä¸ªæˆ‘ä»¬ä¹‹åé‡åˆ°æ—¶å€™å†è®²è§£ã€‚

å½“ç„¶äº†ï¼Œä½ å¯ä»¥æŠŠæ•°æ®ä»¥STATA, SPSS, Excelæ ¼å¼å­˜å‚¨ä¸‹æ¥, ä¸è¿‡ä½ çœŸçš„æƒ³è¿™æ ·å—ï¼Ÿ

### ä½“é¢åœ°å‚¨å­˜æ•°æ®

STATA (.dta, \<14): 3.16 G = R (.rds): 0.05 G

| **Method**       | **Average Time** | **Minimum** | **Maximum** |
|:-----------------|:----------------:|:-----------:|:-----------:|
| base::readRDS    |       19.65      |    18.64    |    21.01    |
| fst::read\_fst   |       1.39       |     0.56    |     3.41    |
| haven::read\_sav |      104.78      |    101.00   |    111.85   |
| qs::qread        |       3.33       |     3.00    |     4.24    |

: å››ç§åœ¨Rä¸­è¯»å–GSSæ•°æ®çš„æ–¹å¼æ‰€ç”¨çš„å¹³å‡æ—¶é—´ï¼ˆä»¥ç§’è®¡ï¼‰

| **Method**      | **Average Time** | **Minimum** | **Maximum** | **File Size** |
|:----------------|:----------------:|:-----------:|:-----------:|:-------------:|
| base::saveRDS   |       98.36      |    93.09    |    103.24   |    30.9 MB    |
| fst::write\_fst |       2.70       |     1.86    |     4.05    |    122.1 MB   |
| qs::qsave       |       5.03       |     4.35    |     6.62    |    44.6 MB    |

: åœ¨Rä¸­å†™å…¥GSSæ•°æ®ï¼ˆåŠæ–‡ä»¶å¤§å°ï¼‰æ‰€ç”¨çš„å¹³å‡æ—¶é—´


## æ•°å­¦è®¡ç®—

```{r math, exercise = TRUE}
x <- y <- 42

# åŸºç¡€æ•°å­¦
x + (1 - 2) * 3 / 4

# é«˜ç­‰æ•°å­¦
x^2;sqrt(x);log(x);exp(x)

# çŸ©é˜µè¿ç®—
z <- matrix(1:4, ncol = 2)
z + z - z
z %*% z  # inner multiplication
z %o% z  # outter multiplication

# å¸ƒå°”é€»è¾‘è®¡ç®—
x == y; x != y
x & y; x | y
x > y; x <= y
```

åœ¨[è¿™é‡Œ](https://towardsdatascience.com/intro-to-r-linear-algebra-2a4de2506c93)æŸ¥çœ‹æ›´å¤šçº¿æ€§ä»£æ•°åœ¨ R ä¸­çš„åº”ç”¨ã€‚

## æ€»ç»“

1. è¾“å…¥
    + `readTYPE`
    + `read_type`
    + `read.type`
1. ä¿å­˜
    + å‘é‡
    + çŸ©é˜µ/data.frame
    + åˆ—è¡¨, æ•°ç»„
1. è¾“å‡º
    + `save`
    + `saveTYPE`

### æ„Ÿè°¢è†å¬ï¼Œä¸‹æ¬¡å†è§ï¼

<i class="fa fa-envelope fa-lg"></i> <yuehu@tsinghua.edu.cn>

<i class="fa fa-globe fa-lg"></i> <https://sammo3182.github.io/>

<i class="fab fa-github fa-lg"></i> [sammo3182](https://github.com/sammo3182)